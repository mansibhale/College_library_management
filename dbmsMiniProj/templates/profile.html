<!DOCTYPE html>
<html lang="en">

<head>
    <!-- Basic -->
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <!-- Mobile Metas -->
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no" />
    <!-- Site Metas -->
    <meta name="keywords" content="" />
    <meta name="description" content="" />
    <meta name="author" content="" />
    <link rel="shortcut icon" href="images/favicon.png" type="">
  
    <title> DBMS </title>
  
    <!-- bootstrap core css -->
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css" />
  
    <!-- fonts style -->
    <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700;900&display=swap" rel="stylesheet">
  
    <!--owl slider stylesheet -->
    <link rel="stylesheet" type="text/css" href="https://cdnjs.cloudflare.com/ajax/libs/OwlCarousel2/2.3.4/assets/owl.carousel.min.css" />
  
    <!-- font awesome style -->
    <link href="css/font-awesome.min.css" rel="stylesheet" />
  
    <!-- Custom styles for this template -->
    <link href="css/style.css" rel="stylesheet" />
    <!-- responsive style -->
    <link href="css/responsive.css" rel="stylesheet" />

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script>
        var x ="", i;
        window.onload = function what(){
          $.ajax({
                  type: "POST",
                  url: "http://127.0.0.1:5000/profile",
                  contentType: "application/json",
                  success: function(response) 
                  {
                    document.getElementById("Welcome").innerHTML = "WELCOME, "+response['user']+" !!";

                    var bklst = response['response'];
                    console.log(bklst)


                    var table = document.createElement("table");
                    table.style.cssText = "border: 1px solid blue;";

                    var th1 = document.createElement("th");
                    th1.style.cssText = "border: 1px solid blue;";
                    th1.textContent = "BookID";
                    table.appendChild(th1);

                    var th2 = document.createElement("th");
                    th2.style.cssText = "border: 1px solid blue;";
                    th2.textContent = "Book Title";
                    table.appendChild(th2);

                    var th3 = document.createElement("th");
                    th3.style.cssText = "border: 1px solid blue;";
                    th3.textContent = "Issued on";
                    table.appendChild(th3);

                    var th4 = document.createElement("th");
                    th4.style.cssText = "border: 1px solid blue;";
                    th4.textContent = " Returned on";
                    table.appendChild(th4);

                    var th5 = document.createElement("th");
                    th5.style.cssText = "border: 1px solid blue;";
                    th5.textContent = "Fine paid";
                    table.appendChild(th5);

                    bklst.forEach(function(row) {
                        var tr = document.createElement("tr");
                        row.forEach(function(cell) {
                            var td = document.createElement("td");
                            td.style.cssText = "border: 1px solid blue;";
                            td.textContent = cell;
                            tr.appendChild(td);
                        });
                        table.appendChild(tr);
            });

            document.getElementById("demo").appendChild(table);


                  }
              });

            
        };
        </script>
  
  </head>
  
  <body class="sub_page">
  
    <div class="hero_area">
  
      <div class="hero_bg_box">
        <div class="bg_img_box">
          <img src="images/hero-bg.png" alt="">
        </div>
      </div>
  
      <!-- header section strats -->
      <header class="header_section">
        <div class="container-fluid">
          <nav class="navbar navbar-expand-lg custom_nav-container ">
            <a class="navbar-brand" href="index.html">
              <span>
                User Profile
              </span>
            </a>
  
            <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarSupportedContent" aria-controls="navbarSupportedContent" aria-expanded="false" aria-label="Toggle navigation">
              <span class=""> </span>
            </button>
  
            <div class="collapse navbar-collapse" id="navbarSupportedContent">
              <li>
                <button class="btn  my-2 my-sm-0 nav_search-btn" type="submit" id="logout">LOGOUT
                  <i class="fa fa-user" aria-hidden="true"></i></button>
                  </li>
              <ul class="navbar-nav  ">
                
                <li class="nav-item ">
                  <a class="nav-link" href="index.html">Home </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="about.html"> About <span class="sr-only">(current)</span> </a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="service.html">AdminPage</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="why.html">For_users</a>
                </li>
                <li class="nav-item">
                  <a class="nav-link" href="team.html">Team</a>
                </li>
                <li class="nav-item active">
                  <a class="nav-link" href="login.html"> <i class="fa fa-user" aria-hidden="true"></i> Login</a>
                </li>
                
              </ul>
            </div>
          </nav>
        </div>
      </header>  
        
    
    
    <style>
        body {
            font-family: 'Roboto', sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f5f5f5;
            color: #333;
        }




        main {
            padding: 20px;
            text-align: center;
        }


        .container {
            max-width: 800px;
            margin: auto;
            background-color: #fff;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
        }


        h1 {
            margin-bottom: 20px;
            font-size: 36px;
            color: #333;
        }


        h2 {
            margin-top: 30px;
            font-size: 28px;
            color: #333;
        }


        ul {
            list-style-type: none;
            padding: 0;
            text-align: left;
            margin-top: 20px;
        }


        li {
            margin-bottom: 10px;
            font-size: 18px;
            color: #666;
        }


        .issued-book {
            margin-top: 20px;
            padding: 10px;
            background-color: #f2f2f2;
            border-radius: 5px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        }


        .book-title {
            font-weight: bold;
            color: #333;
        }


        .return-date {
            color: #007bff;
        }


        .fine {
            color: #dc3545;
        }


        footer {
            background-color: #333;
            color: #fff;
            text-align: center;
            padding: 10px 0;
            position: fixed;
            bottom: 0;
            width: 100%;
            font-size: 14px;
        }
    </style>
</head>


<body>
        
    <main>
        
        <div class="container">
            <h1 id="Welcome"></h1>
            <h2>Issued Books</h2>
            
            <div id="demo" class="issued-book"></div>

        </div>
    </main>

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>

    <script type="text/javascript">
        
        document.getElementById("logout").addEventListener("click",function() 
        {
            console.log("logout");

            $.ajax({
                type: "POST",
                url: "http://127.0.0.1:5000/logout",
                success: function(response) 
                {
                  if(response==="valid")
                  {
                    window.location.href = "login.html";
                  }
                  else
                  {
                    window.alert("Did not logout");
                  }
                },
                error: function(xhr, status, error) 
                {
                  console.error("AJAX request error:", error);
                  alert("An error occurred. Please try again later.");
                }
            });
        }); 


    </script>

</body>


</html>
